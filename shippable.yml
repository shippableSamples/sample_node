# Language setting
language: 
  - node_js
  - another_lang
  
build_image: shippable/minv2
# Version number
node_js:
  - 0.10.25

# The path for Xunit to output test reports
env:
  - XUNIT_FILE=shipable/testresults/result.xml
  
notifications:
  email:
    recipients:
      - john@shippable.com
    on_success: always

# Create directories for test and coverage reports
before_script:
  - mkdir -p shipable/testresults
  - mkdir -p shipable/codecoverage
  - echo 'really long line really long line really long line really long line really long line really long line really long line really long line really long line really long line really long line really long line really long line really long line '
  #- touch shippable/codecoverage/cobertura-coverage.xml
  #-	echo '<?xml version="1.0" ?>' >> shippable/codecoverage/cobertura-coverage.xml
  #-	echo '<!DOCTYPE coverage SYSTEM "http://cobertura.sourceforge.net/xml/coverage-04.dtd">' >> shippable/codecoverage/cobertura-coverage.xml
  #-	echo '<coverage lines-valid="19"  lines-covered="15"  line-rate="1"  branches-valid="0"  branches-covered="0"  branch-rate="1"  timestamp="1420757434726" complexity="0" version="0.1">' >> shippable/codecoverage/cobertura-coverage.xml
  #-	echo '</coverage>' >> shippable/codecoverage/cobertura-coverage.xml
   

# Running the tests with grunt
script:
  - echo 'grunt!'
  - grunt

# Tell istanbul to generate a coverage report
after_script:
  - echo 'coverage'
  - ./node_modules/.bin/istanbul cover grunt -- -u tdd
  - ./node_modules/.bin/istanbul report cobertura --dir  shipable/codecoverage/
  - ls -la shipable/codecoverage/
  - cat shipable/codecoverage/cobertura-coverage.xml
